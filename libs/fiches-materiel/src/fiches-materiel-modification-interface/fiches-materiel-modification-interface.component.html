<!-- <div>dataIdFicheMaterielReady : {{dataIdFicheMaterielReady | json}}</div>
<div>displayNewObjectReady : {{displayNewObjectReady | json}}</div>
<div>allGetReady : {{allGetReady | json}}</div> -->
<!-- {{newObject | json}} -->
<!-- {{fmInRecording | json}} -->
<loader-animation *ngIf="!displayNewObjectReady || !allGetReady"></loader-animation>
<div *ngIf="displayNewObjectReady && allGetReady" class="row form-group fm-details">
  <form class="card col-lg-12">
    <div class="row">
      <div class="col-lg-12 text-center modif-header">
        {{modificationMessage}}
      </div>
    </div>
     <!-- {{initialFichesMateriel | json}} -->
    <fiches-materiel-modification-action
      (modificationMessage)="displayModificationMessage($event)"
      (propertiesChanged)="resetPropertiesChanged($event)"
      (fmInRecordingEvent)="checkCurrentRecord($event)"
      [fmInRecording]="fmInRecording"
      (modifInProgressMessage)="displayModifInProgressMessage($event)"
      class="creation-top"
      [showAffectedEps]="false"
      [annexElementsNgModel]="annexElementsNgModel"
      [allFichesMateriel]="allFichesMateriel"
      [selectionType]="selectionType"
      [multiOeuvre]="multiOeuvre"
      [multiFichesAchat]="multiFichesAchat"
      [initialFichesMateriel]="initialFichesMateriel"
      [valueNotToChangeLibelle]="valueNotToChangeLibelle"
      [allIdSelectedFichesMateriel]="allIdSelectedFichesMateriel"
      [qualiteFM]="qualiteFM"
      [versionFicheMateriel]="versionFicheMateriel"
      [annexElementsFicheMateriel]="annexElementsFicheMateriel"
      [allAnnexElementsFicheMateriel]="allAnnexElementsFicheMateriel"
      [user]="user"
      [deadlineIsValid]="deadlineIsValid"
      [livraisonIsValid]="livraisonIsValid"
      [acceptationIsValid]="acceptationIsValid"
      [oriIsValid]="oriIsValid"
      [premiereDiff]="premiereDiff"
      [accesLabo]="accesLabo"
      [comments]="comments"
      [allEACommentsMultiSelect]="allEACommentsMultiSelect"
      [allVersionFm]="allVersionFm"
      [versionFmNgModel]="versionFmNgModel"
      [allQualitiesFm]="allQualitiesFm"
      [qualityFmNgModel]="qualityFmNgModel"
      [newObject]="newObject">
    </fiches-materiel-modification-action>
    <!-- {{newObject | json}} -->
    <!-- {{annexElementsFicheMateriel | json}} -->
  <div *ngIf="fmInRecording && selectionType === 'multi'" class="modif-in-progress">
    <loader-animation ></loader-animation>
    <div class="recording-message"><p>{{modifInProgressMessage}}</p></div>
    <div class="warning-message"><p><i class="warning-icon icofont icofont-warning"></i>Quitter la page entraînera des pertes de données</p></div>
  </div>
  <div *ngIf="!fmInRecording">
    <div class="row top">
      <div class="col-lg-3 left-infos" [ngClass]="newObject.Isurgence === true ? 'urgent-deadline' : ''">
        <div *ngIf="!fmInRecording" class="form-group row deadline-group">
          <i *ngIf="warningDeadlineExist" class="deadline-warning warning-icon icofont icofont-warning"></i>
          <label class="deadline clo-lg-4 col-form-label">
            Deadline :</label>
              <div *ngIf="!fmInRecording" class="input-group deadline-datepicker inline-datepicker col-lg-8">
                <input class="form-control input-deadline"
                  [ngClass]="!checkValidDate(newObject.Deadline) && !fmInRecording ? 'form-control-danger' : ''"
                  placeholder="{{newObject.Deadline}}" 
                  name="deadlineDate" 
                  [(ngModel)]="newObject.Deadline" 
                  [disabled]="disabledDeadline()"
                  ngbDatepicker
                  (dateSelect)="selectionType === 'one' ? displayValidDate(newObject.Deadline, 'deadline') : displayValidDate(deadline.value, 'deadline')"
                  (keyup)="selectionType === 'one' ? displayValidDate(newObject.Deadline, 'deadline') : displayValidDate(deadline.value, 'deadline')"
                  #deadline="ngModel"
                  #deadlineDate="ngbDatepicker">
                <div class="input-group-append deadline-calendar">
                  <button class="btn btn-outline-secondary" (click)="deadlineDate.toggle()" type="button" [ngClass]="warningDeadlineExist ? 'warning-btn' : ''" >
                    <i class="icofont icofont-calendar" [ngClass]="warningDeadlineExist ? 'warning-color' : ''"></i>
                  </button>
                </div>
              </div>
              <div *ngIf="!checkValidDate(newObject.Deadline) && !fmInRecording" class="col-form-label invalid-form">La Deadline n'est pas valide</div>
              <div *ngIf="warningDeadlineExist && !fmInRecording && deadlineDaysDiff > 0" class="deadline-message">La Deadline est dépassée depuis 
                <span class="deadline-day-past">{{deadlineDaysDiff}}</span>
                <span *ngIf="deadlineDaysDiff > 1">jours</span>
                <span *ngIf="deadlineDaysDiff === 1">jour</span>
              </div>
        </div>
        <div class="form-group row suivi-group">
          <label class="user clo-lg-4 col-form-label">
            Suivi par :</label>
          <select name="select" class="form-control col-lg-8" [(ngModel)]="newObject.SuiviPar" >
            <option [ngValue]="newObject.SuiviPar">{{newObject.SuiviPar}}</option>
            <option *ngFor="let name of displayOthersUsersWithModificationRight(newObject.SuiviPar)" [ngValue]="name">
              <span *ngIf="name !== newObject.SuiviPar">{{name}}</span>
            </option>
          </select>
        </div>
      </div>
      <div class="col-lg-6 title" *ngIf="selectionType === 'one'">
        <div *ngIf="newObject.Isurgence === true" class="urgent-warning">
          <i class="icon icofont icofont-warning-alt"></i>
          <p>Fiche urgente</p>
        </div>
        <h1>
          {{newObject.TitreEpisodeVF}}
        </h1>
        <h2>
           {{newObject.TitreEpisodeVO}}
        </h2>
          <div class="eps-ab">
            <label class="col-form-label">N° Episode AB : </label>
            <input 
              [(ngModel)]="newObject.NumEpisodeAB"
              type="text"
              class="form-control" 
              id="epAb" 
              name="epAb"
              autocomplete="off">
              <div class="icons col-lg-6" *ngIf="selectionType === 'multi'">
                <i *ngIf="newObject.NumEpisodeAB !== ''"
                  class="icofont icofont-close-line-circled delete"
                  [placement]="'right'" 
                  [ngbTooltip]="resetTooltipMessage"
                  (click)="newObject.NumEpisodeAB = ''">
                </i>
                <i *ngIf="(newObject.NumEpisodeAB !== valueNotToChangeLibelle)"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="newObject.NumEpisodeAB = valueNotToChangeLibelle">
                </i>
              </div>
          </div>


      </div>
      <div class="col-lg-6" *ngIf="selectionType === 'multi'">
        <div *ngIf="newObject.Isurgence === true" class="urgent-warning">
          <i class="icon icofont icofont-warning-alt"></i>
          <p>Fiches urgentes</p>
        </div>
      </div>
    </div>
     <!-- {{newObject.IdLibstatut | json}}
     {{newObject.IdLibEtape | json}}
     {{stepsReady}} -->
    <div class="row state-content" *ngIf="stepsReady && statusReady">
      <div class="col-lg-6 state form-group">
        <label class="col-form-label">Statut : </label>
          <select name="statut" class="form-control" [(ngModel)]="newObject.IdLibstatut" (click)="clickStatusOptions()">
            <option *ngIf="initValueStatus" [ngValue]="newObject.IdLibstatut">
              <span *ngIf="newObject.IdLibstatut !== valueNotToChangeLibelle">{{newObject.IdLibstatut}} - {{displayInitialStatus(newObject)}}</span>
              <span *ngIf="newObject.IdLibstatut === valueNotToChangeLibelle">{{newObject.IdLibstatut}}</span>
            </option>
            <option *ngFor="let stat of status" [ngValue]="stat.Libelle !== valueNotToChangeLibelle ? stat.IdLibstatut : stat.Libelle">
              <span *ngIf="stat.Libelle !== valueNotToChangeLibelle">{{status.indexOf(stat) + 1}} - </span>{{stat.Libelle}}</option>
          </select>
        </div>
      <div class="col-lg-6 step form-group" *ngIf="steps['id'+newObject.IdLibstatut] !== [] && newObject.IdLibstatut !== valueNotToChangeLibelle">
        <label class="col-form-label">Etape : </label>
          <select name="myStep" class="form-control" 
                  [(ngModel)]="newObject.IdLibEtape" 
                  (click)="clickStepOptions()" 
                  *ngIf="stepsReady">
            <option *ngIf="initValueSteps" [ngValue]="newObject.IdLibEtape" [selected]="true">
              <span *ngIf="newObject.IdLibEtape !== valueNotToChangeLibelle">{{newObject.IdLibEtape}} - {{displayInitialStep(newObject)}}</span>
              <span *ngIf="newObject.IdLibEtape === valueNotToChangeLibelle">{{newObject.IdLibEtape}}</span>
            </option>
            <option 
              *ngFor="let step of steps['id'+newObject.IdLibstatut]; let i= index" 
              [ngValue]="displayStepValue(step)">
              <span *ngIf="step.Libelle !== valueNotToChangeLibelle">{{i+1}} - </span>{{step.Libelle}}
            </option>
          </select>
<!-- {{newObject | json }} -->
<div class="step-status-icons">

        <div 
            class="add-just-comment"
            [placement]="'right'" 
            [ngbTooltip]="'Ajouter un commentaire'"
            (click)="addJustCommentSwal()">
            <i class="icofont icofont-comment"></i>
          </div>
          <history-steps-status-modal
            class="history-steps-status-modal-component"
            *ngIf="selectionType === 'one'" 
            [reload]="reload"
            [myFicheMateriel]="this.allFichesMateriel[0]" 
            [statusLib]="status"
            [stepLib]="allSteps">
          </history-steps-status-modal>
          <div class="history" *ngIf="selectionType === 'multi'">
            <i class="icofont icofont-history"></i>
          </div>
</div>

      </div>

    </div>
     <!-- {{newObject.IdLibstatut}}
     {{newObject.IdLibEtape}} -->
    <steps-status-comment-modal
      (newComment)="displayStepsStatusModelComment($event)"
      (lastStatus)="displayPreviousStatus($event)"
      (lastStep)="displayPreviousStep($event)"
      (backToOldStepStatus)="displayPreviousStatusStep($event)"
      [selectionType]="selectionType"
      [step]="newObject.IdLibEtape"
      [status]="newObject.IdLibstatut" 
      [newObject]="newObject"
      [valueNotToChangeLibelle]="valueNotToChangeLibelle"
      [acceptedStatusIsPossible]="acceptedStatusIsPossible"
      [allFichesMateriel]="allFichesMateriel">
    </steps-status-comment-modal>
    <!-- <div class="row fm-other-fiches-achat" 
      *ngIf="allFichesAchatForOeuvreReady 
        && checkOeuvreInAllFicheAchatForOeuvre(ficheAchatDetail, allFichesAchatsForAllOeuvres)
        && multiOeuvre
        && otherFichesAchatForOeuvreExist">
      <div class="col-lg-12 other-fiches-achat-content">
        <div *ngFor="let item of allFichesAchatForOeuvre" class="other-fiches-achat">OUI (1) L'oeuvre n°<span>{{item[0].NumProgram}}</span> apparait dans plusieurs fiches Achat :
          <span *ngFor="let ficheAchat of item">
            <label class="label label-inverse-danger">{{ficheAchat.Numero_fiche}}</label>
          </span>
        </div>
      </div>
    </div>
    <div class="row fm-other-fiches-achat" 
      *ngIf="allFichesAchatForOeuvreReady 
        && !multiOeuvre
        && otherFichesAchatForOeuvreExist">
      <div class="col-lg-12 other-fiches-achat-content">
        <div *ngFor="let item of allFichesAchatForOeuvre" class="other-fiches-achat">L'oeuvre apparait dans d'autres fiches Achat :
          <span *ngFor="let ficheAchat of item">
            <label class="label label-inverse-danger">{{ficheAchat.Numero_fiche}}</label>
          </span>
        </div>
      </div>
    </div> -->
    <div class="row fm-other-fiches-achat" 
      *ngIf="allFichesAchatForOeuvreReady && otherFichesAchatForOeuvreExist">
      <div class="col-lg-12 other-fiches-achat-content">
        <div *ngFor="let item of messageOthersFichesAchatForOeuvre" class="other-fiches-achat">{{item.text}}
          <!-- <span *ngFor="let ficheAchat of item.fichesAchat"> -->
            <label *ngFor="let numeroFiche of item.fichesAchat[0]" class="label label-inverse-danger">{{numeroFiche.Numero_fiche}}</label>
          <!-- </span> -->
        </div>
      </div>
    </div>
    <!-- <span>multioeuvre : {{!multiOeuvre}}</span>
    <span>!checkOeuvreInAllFicheAchatForOeuvre(ficheAchatDetail, allFichesAchatsForAllOeuvres) : {{!checkOeuvreInAllFicheAchatForOeuvre(ficheAchatDetail, allFichesAchatsForAllOeuvres)}}</span>
    <span>allFichesAchatForOeuvreReady : {{allFichesAchatForOeuvreReady}}</span> -->

    <!-- <div class="row fm-other-fiches-achat" 
        *ngIf="!multiOeuvre 
          && !checkOeuvreInAllFicheAchatForOeuvre(ficheAchatDetail, allFichesAchatsForAllOeuvres) 
          && allFichesAchatForOeuvreReady">
      <div class="col-lg-12 other-fiches-achat-content">
        <div *ngFor="let item of allFichesAchatsForAllOeuvres" class="other-fiches-achat">OUI (2)L'oeuvre n°
          <span>{{item[0].NumProgram}}</span> a été retirée de la fiche Achat mais elle apparait dans d'autres fiches :
          <span *ngFor="let ficheAchat of item">
            <label class="label label-inverse-danger">{{ficheAchat.Numero_fiche}}</label>
          </span>
        </div>
      </div>
    </div> -->
    <div class="row urgent-modif">
      <div class="col-lg-6 urgent-checkbox">
        <div class="checkbox-color checkbox-danger">
          <i *ngIf="newObject.Isurgence === false && selectionType === 'multi'" class="icofont icofont-close-line not-valid"></i>
          <input 
            id="Isurgence" 
            type="checkbox" 
            [checked]="displayCheckedIsUrgence()" 
            (click)="displayIsUrgence()"
            [disabled]="disabledUrgence()"
            name="Isurgence">
            <!-- [disabled]="disabledUrgence()" -->
          <label for="Isurgence">
            Mettre en évidence<span *ngIf="newObject.Isurgence === valueNotToChangeLibelle">(certaines fiches sélectionnées sont mises en évidence)</span>
          </label>
        </div>
        <div class="icons col-lg-2 ml-0 reply-urgent" *ngIf="selectionType === 'multi'">
          <i *ngIf="!disabledUrgence() && (newObject.Isurgence !== valueNotToChangeLibelle) && !checkIsOriginalProperty('Isurgence', newObject.Isurgence)"
            class="icofont icofont-ui-reply reply"
            [placement]="'right'" 
            [ngbTooltip]="replyTooltipMessage"
            (click)="newObject.Isurgence = valueNotToChangeLibelle">
          </i>
          <i *ngIf="!disabledUrgence() && (newObject.Isurgence !== valueNotToChangeLibelle) 
            && (checkIsOriginalProperty('Isurgence', newObject.Isurgence)
            && newObject.Isurgence !== equalObject.Isurgence[0])" 
            class="icofont icofont-ui-reply reply" 
            [placement]="'right'"
            [ngbTooltip]="replyTooltipMessage" 
            (click)="checkIsOriginalProperty('Isurgence', newObject.Isurgence) ? 
            newObject.Isurgence = equalObject.Isurgence[0] : 
            newObject.Isurgence = valueNotToChangeLibelle">
          </i>
        </div>
      </div>
    </div>
    <div class="row fm-detail-body"> <!-- CONTIENT TOUTES LES SECTIONS -->
      <div class="col-lg-4 fm-content">
         <!-- custom height -->
        <!-- <div class="sections info" #info [ngStyle]="selectionType === 'multi' ? {'min-height': '580px'} : {'min-height': '740px'}">  -->
        <div class="sections info" #info [ngStyle]="{'min-height': '100%'}">
          <i class="icofont icofont-info-circle section-icon"></i>
          <p *ngIf="selectionType === 'one' || (selectionType === 'multi' && !multiFichesAchat)"> N° fiche Achat :
            <span *ngIf="ficheAchatReady">{{ficheAchat.numero_fiche}}</span>
          </p>
          <p *ngIf="selectionType === 'multi' && multiFichesAchat && ficheAchatReady && ficheAchatMulti.numero_fiche"> N° fiche Achat :
            <span>{{ficheAchatMulti.numero_fiche}}</span>
          </p>
          <p *ngIf="selectionType === 'one' || (selectionType === 'multi' && !multiFichesAchat)">Nom cessionnaire : 
            <span *ngIf="ficheAchatReady">{{ficheAchat.nom_cessionnaire}}</span>
          </p>
          <p *ngIf="selectionType === 'multi' && multiFichesAchat && ficheAchatReady && ficheAchatMulti.nom_cessionnaire">Nom cessionnaire :
            <span>{{ficheAchatMulti.nom_cessionnaire}}</span>
          </p>
          <p *ngIf="selectionType === 'one' || (selectionType === 'multi' && !multiFichesAchat)">Type de fiche Achat :
            <span *ngIf="ficheAchatReady">{{ficheAchat.libelle_type_fiche}}</span>
          </p>
          <p *ngIf="selectionType === 'multi' && multiFichesAchat && ficheAchatReady && ficheAchatMulti.libelle_type_fiche">Type de fiche Achat :
            <span>{{ficheAchatMulti.libelle_type_fiche}}</span>
          </p>
          <p *ngIf="selectionType === 'one'">
            <a href="{{detailedReportLink}}" target="_blank" class="rapport-link" placement="top" ngbTooltip="Voir le rapport détaillé de la Fiche Achat">
              <i class="icofont icofont-list rapport-icon"></i>
              <span>Rapport détaillé</span>
            </a>
          </p>
          <p *ngIf="(selectionType === 'one' || (selectionType === 'multi' && !multiFichesAchat)) && ficheAchatReady"> Distributeur :
            <span *ngIf="ficheAchat.Distributeur">
              {{ficheAchat.Distributeur}}
            </span>
            <span *ngIf="!ficheAchat.Distributeur">
              /
            </span>
          </p>
          <p *ngIf="selectionType === 'multi' && multiFichesAchat && ficheAchatReady && ficheAchatMulti.Distributeur">Type de fiche Achat :
            <span>{{ficheAchatMulti.Distributeur}}</span>
          </p>

          <!-- <p *ngIf="selectionType === 'one'">Année prod :
            <span>
             FICHE ACHAT
            </span>
          </p> -->

          <div class="row form-group" [ngClass]="selectionType === 'multi' ? 'first-label' : ''">
            <label class="col-form-label col-lg-4 inline-label">N° Episode Prod : </label>
            <input 
              [(ngModel)]="newObject.NumEpisodeProd"
              placeholder="{{newObject.NumEpisodeProd ? valueNotToChangeLibelle : ''}}"
              type="text"
              class="form-control col-lg-4 inline-input" 
              id="epProd" 
              name="epProd"
              autocomplete="off">
              <div class="icons col-lg-2" *ngIf="selectionType === 'multi'">
                <i *ngIf="newObject.NumEpisodeProd !== ''"
                  class="icofont icofont-close-line-circled delete"
                  [placement]="'right'" 
                  [ngbTooltip]="resetTooltipMessage"
                  (click)="newObject.NumEpisodeProd = ''">
                </i>
                <!-- <i *ngIf="newObject.NumEpisodeProd !== valueNotToChangeLibelle"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="newObject.NumEpisodeProd = valueNotToChangeLibelle">
                </i> -->
                <i *ngIf="(newObject.NumEpisodeProd !== valueNotToChangeLibelle) && !checkIsOriginalProperty('NumEpisodeProd', newObject.NumEpisodeProd)"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="newObject.NumEpisodeProd = valueNotToChangeLibelle">
                </i>
                <i *ngIf="(newObject.NumEpisodeProd !== valueNotToChangeLibelle) 
                  && (checkIsOriginalProperty('NumEpisodeProd', newObject.NumEpisodeProd)
                  && newObject.NumEpisodeProd !== equalObject.NumEpisodeProd[0])" 
                  class="icofont icofont-ui-reply reply" 
                  [placement]="'right'"
                  [ngbTooltip]="replyTooltipMessage" 
                  (click)="checkIsOriginalProperty('NumEpisodeProd', newObject.NumEpisodeProd) ? 
                  newObject.NumEpisodeProd = equalObject.NumEpisodeProd[0] : 
                  newObject.NumEpisodeProd = valueNotToChangeLibelle">
                </i>
                <!-- <i *ngIf="newObject.NumEpisodeProd !== allFichesMateriel[0].NumEpisodeProd && selectionType === 'one'"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="newObject.NumEpisodeProd = allFichesMateriel[0].NumEpisodeProd">
                </i> -->
              </div>
          </div>
          <!-- <p>N° Episode Prod : ooooooooooo</p> -->
          <div class="row form-group">
            <label class="col-form-label col-lg-4 inline-label">N° Episode AB : </label>
            <input 
              [(ngModel)]="newObject.NumEpisodeAB"
              type="text" 
              class="form-control col-lg-4 inline-input" 
              id="epAb" 
              name="epAb"
              autocomplete="off">              
              <div class="icons col-lg-2" *ngIf="selectionType === 'multi'">
                <i *ngIf="newObject.NumEpisodeAB !== ''"
                  class="icofont icofont-close-line-circled delete"
                  [placement]="'right'" 
                  [ngbTooltip]="resetTooltipMessage"
                  (click)="newObject.NumEpisodeAB = ''">
                </i>
                <i *ngIf="(newObject.NumEpisodeAB !== valueNotToChangeLibelle) && !checkIsOriginalProperty('NumEpisodeAB', newObject.NumEpisodeAB)"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="newObject.NumEpisodeAB = valueNotToChangeLibelle">
                </i>
                <i *ngIf="(newObject.NumEpisodeAB !== valueNotToChangeLibelle) 
                  && (checkIsOriginalProperty('NumEpisodeAB', newObject.NumEpisodeAB)
                  && newObject.NumEpisodeAB !== equalObject.NumEpisodeAB[0])" 
                  class="icofont icofont-ui-reply reply"   
                  [placement]="'right'"
                  [ngbTooltip]="replyTooltipMessage" 
                  (click)="checkIsOriginalProperty('NumEpisodeAB', newObject.NumEpisodeAB) ? 
                  newObject.NumEpisodeAB = equalObject.NumEpisodeAB[0] : 
                  newObject.NumEpisodeAB = valueNotToChangeLibelle">
                </i>
              </div>
          </div>

          <p *ngIf="(selectionType === 'one' || (selectionType === 'multi' && !multiOeuvre)) && ficheAchatDetailReady">Format œuvre :
              <span *ngIf="ficheAchatDetailsExist && ficheAchatDetail.nombre_episodes">
                {{ficheAchatDetail.nombre_episodes ? ficheAchatDetail.nombre_episodes + ' épisode(s)' : '/'}}
              </span>
              <span *ngIf="ficheAchatDetailsExist && !ficheAchatDetail.nombre_episodes">
                /
              </span>
              <span *ngIf="!ficheAchatDetailsExist">
                <i class="icofont icofont-minus-circle warning"></i>
                {{messageNoFicheAchatDetail}}
              </span>
              <span 
                *ngIf="ficheAchatDetailsExist && ficheAchatDetail.nombre_episodes && propertyExist(ficheAchatDetail.DurCom, ficheAchatDetail)" 
                [placement]="'right'" 
                [ngbTooltip]="propertyExist(ficheAchatDetail.DurCom, ficheAchatDetail) ? ficheAchatDetail.DurCom : ''">
                de {{displayDurCom(ficheAchatDetail.DurCom)}}
              </span>
              <p *ngIf="selectionType === 'multi' && multiOeuvre && ficheAchatDetailReady && ficheAchatDetailMulti.nombre_episodes">Format œuvre :
                  <span>{{ficheAchatDetailMulti.nombre_episodes}}</span>
                  <span 
                    *ngIf="ficheAchatDetailMulti.nombre_episodes && propertyExist(ficheAchatDetailMulti.DurCom, ficheAchatDetailMulti)" 
                    [placement]="'right'" 
                    [ngbTooltip]="propertyExist(ficheAchatDetailMulti.DurCom, ficheAchatDetailMulti) ? ficheAchatDetailMulti.DurCom : ''">
                    de {{displayDurCom(ficheAchatDetailMulti.DurCom)}}
                  </span>
              </p>
        
          <p class="inline-label" *ngIf="(selectionType === 'one' || (selectionType === 'multi' && !multiOeuvre)) && !ficheAchatDetailReady">Format œuvre :
            <span>/</span>
          </p>
          <div class="row form-group">
            <label class="col-form-label col-lg-4 inline-label">N° œuvre : </label>
            <input 
              [(ngModel)]="newObject.NumProgram"
              type="text" 
              class="form-control col-lg-4 inline-input" 
              id="numProg" 
              name="numProg"
              autocomplete="off">              
              <div class="icons col-lg-2" *ngIf="selectionType === 'multi'">
                <i *ngIf="newObject.NumProgram !== ''"
                  class="icofont icofont-close-line-circled delete"
                  [placement]="'right'" 
                  [ngbTooltip]="resetTooltipMessage"
                  (click)="newObject.NumProgram = ''">
                </i>
                <!-- <i *ngIf="newObject.NumProgram !== valueNotToChangeLibelle"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="newObject.NumProgram = valueNotToChangeLibelle">
                </i> -->
                <i *ngIf="(newObject.NumProgram !== valueNotToChangeLibelle) && !checkIsOriginalProperty('NumProgram', newObject.NumProgram)"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="newObject.NumProgram = valueNotToChangeLibelle">
                </i>
                <i *ngIf="(newObject.NumProgram !== valueNotToChangeLibelle) 
                  && (checkIsOriginalProperty('NumProgram', newObject.NumProgram)
                  && newObject.NumProgram !== equalObject.NumProgram[0])" 
                  class="icofont icofont-ui-reply reply" 
                  [placement]="'right'"
                  [ngbTooltip]="replyTooltipMessage" 
                  (click)="checkIsOriginalProperty('NumProgram', newObject.NumProgram) ? 
                  newObject.NumProgram = equalObject.NumProgram[0] : 
                  newObject.NumProgram = valueNotToChangeLibelle">
                </i>
              </div>
          </div>
            
          <div class="row form-group">
            <label class="col-form-label col-lg-4 inline-label">Titre épisode VF : </label>
            <input 
              [(ngModel)]="newObject.TitreEpisodeVF"
              type="text" 
              class="form-control col-lg-4 inline-input" 
              id="titleEpVf" 
              name="titleEpVf"
              autocomplete="off">
              <div class="icons col-lg-2" *ngIf="selectionType === 'multi'">
                <i *ngIf="newObject.TitreEpisodeVF !== ''"
                  class="icofont icofont-close-line-circled delete"
                  [placement]="'right'" 
                  [ngbTooltip]="resetTooltipMessage"
                  (click)="newObject.TitreEpisodeVF = ''">
                </i>
                <i *ngIf="(newObject.TitreEpisodeVF !== valueNotToChangeLibelle) && !checkIsOriginalProperty('TitreEpisodeVF', newObject.TitreEpisodeVF)"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="newObject.TitreEpisodeVF = valueNotToChangeLibelle">
                </i>
                <i *ngIf="(newObject.TitreEpisodeVF !== valueNotToChangeLibelle) && (checkIsOriginalProperty('TitreEpisodeVF', newObject.TitreEpisodeVF) && newObject.TitreEpisodeVF !== equalObject.TitreEpisodeVF[0])"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="checkIsOriginalProperty('TitreEpisodeVF', newObject.TitreEpisodeVF) ? newObject.TitreEpisodeVF = equalObject.TitreEpisodeVF[0] : newObject.TitreEpisodeVF = valueNotToChangeLibelle">
                </i>
              </div>
          </div>

          <div class="row form-group">
            <label class="col-form-label col-lg-4 inline-label">Titre épisode VO :</label>
            <input 
              [(ngModel)]="newObject.TitreEpisodeVO"
              type="text" 
              class="form-control col-lg-4 inline-input" 
              id="titleEpVo" 
              name="titleEpVo"
              autocomplete="off">
              <div class="icons col-lg-2" *ngIf="selectionType === 'multi'">
                <i *ngIf="newObject.TitreEpisodeVO !== ''"
                  class="icofont icofont-close-line-circled delete"
                  [placement]="'right'" 
                  [ngbTooltip]="resetTooltipMessage"
                  (click)="newObject.TitreEpisodeVO = ''">
                </i>
                <i *ngIf="(newObject.TitreEpisodeVO !== valueNotToChangeLibelle) && !checkIsOriginalProperty('TitreEpisodeVO', newObject.TitreEpisodeVO)"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="newObject.TitreEpisodeVO = valueNotToChangeLibelle">
                </i>
                <i *ngIf="(newObject.TitreEpisodeVO !== valueNotToChangeLibelle) 
                  && (checkIsOriginalProperty('TitreEpisodeVO', newObject.TitreEpisodeVO) 
                  && newObject.TitreEpisodeVO !== equalObject.TitreEpisodeVO[0])"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="checkIsOriginalProperty('TitreEpisodeVO', newObject.TitreEpisodeVO) ? 
                    newObject.TitreEpisodeVO = equalObject.TitreEpisodeVO[0] : 
                    newObject.TitreEpisodeVO = valueNotToChangeLibelle">
                </i>
              </div>
          </div>

<!-- 
{{versionFicheMateriel | json}}
{{versionLib | json}} -->
          <div class="row form-group">
            <label class="col-form-label col-lg-3 inline-label">Version : </label>
            <div *ngIf="selectionType !== 'multi'" class="right-details col-lg-6">
              <div *ngFor="let item of versionLib; let i = index" class="checkbox-color checkbox-success">
                <input 
                  class="inline-input"
                  id="{{item.version_mat}}"
                  type="checkbox"
                  (click)="changeModelVersion(item.id_version)"
                  [checked]="displayCheckedVersion(item.id_version)"
                  name="{{item.version_mat}}">
                <label for="{{item.version_mat}}">
                  {{item.version_mat}}
                </label>
              </div>
              <!-- <div *ngFor="let item of versionLib; let i = index" class="checkbox-color checkbox-info">
                <input 
                  (click)="changeVersionChecked(item.id_version)"
                  id="{{item.IdMat_Version}}"
                  type="checkbox"
                  [checked]="displayVersionChecked(item.id_version)"
                  name="{{item.version_mat}}">
                <label for="{{item.version_mat}}">
                  {{item.version_mat}}
                </label>
              </div> -->
            </div>
            <div *ngIf="selectionType === 'multi' && versionMultiReady && versionLib" class="right-details col-lg-6">
              <div *ngFor="let item of versionLib; let i = index" class="checkbox-color checkbox-success">
                <i class="icofont icofont-close-line not-valid" [ngClass]="checkIfVersionValueIsNotValid(item.id_version) ? 'itemNotValid' : 'itemValid' "></i>
                <input 
                  id="{{item.version_mat}}"
                  type="checkbox"
                  (click)="changeModelVersion(item.id_version)"
                  [checked]="displayCheckedVersion(item.id_version)"
                  name="{{item.version_mat}}">
                <label for="{{item.version_mat}}">
                  {{item.version_mat}}
                </label>
              </div>
            </div>
            <div class="icons col-lg-2 ml-0" *ngIf="selectionType === 'multi' && versionMultiReady && versionLib">
                <i *ngIf="displayClearVersionsIcon()"
                  class="icofont icofont-close-line-circled delete"
                  [placement]="'right'" 
                  [ngbTooltip]="'vider tous les champs'"
                  (click)="clearAllVersionsValue()">
                </i>
                <i *ngIf="displayResetVersionsIcon()"
                  class="icofont icofont-ui-reply reply" 
                  [placement]="'right'"
                  [ngbTooltip]="'revenir aux valeurs d\'origines'"
                  (click)="resetAllVersionsValue()">
                </i>
              </div>
            <!-- {{checkIfValueIsNotValid(id_version)}}
            {{versionLib | json}}
            {{versionFicheMateriel | json}} -->
          </div>
            <!-- {{versionFmNgModel | json}} -->



          <div class="row form-group" *ngIf="qualiteFmReady">
            <label class="col-form-label col-lg-3 inline-label">Qualité : </label>
            <div *ngIf="qualiteReady && selectionType !== 'multi'" class="right-details col-lg-6">
              <div *ngFor="let item of qualiteLib; let i = index" class="checkbox-color checkbox-success">
                <input 
                  class="inline-input"
                  id="{{item.Libelle}}"
                  type="checkbox"
                  (click)="changeModelQualite(item.Code)"
                  [checked]="displayCheckedQualite(item.Code)"
                  name="{{item.Libelle}}">
                <label for="{{item.Libelle}}">
                  {{item.Libelle}}
                </label>
              </div>
            </div>

            <div *ngIf="selectionType === 'multi' && qualityMultiReady && qualiteLib" class="right-details col-lg-6">
              <div *ngFor="let item of qualiteLib; let i = index" class="checkbox-color checkbox-success">
                <i class="icofont icofont-close-line not-valid" [ngClass]="checkIfQualityValueIsNotValid(item.Code) ? 'itemNotValid' : 'itemValid' "></i>
                <input 
                  id="{{item.Libelle}}"
                  type="checkbox"
                  (click)="changeModelQualite(item.Code)"
                  [checked]="displayCheckedQualite(item.Code)"
                  name="{{item.Libelle}}">
                <label for="{{item.Libelle}}">
                  {{item.Libelle}}
                </label>
              </div>
            </div>
            <div class="icons col-lg-2 ml-0" *ngIf="selectionType === 'multi' && qualityMultiReady && qualiteLib">
              <i *ngIf="displayClearQualitiesIcon()"
                class="icofont icofont-close-line-circled delete"
                [placement]="'right'" 
                [ngbTooltip]="'vider tous les champs'"
                (click)="clearAllQualitiesValue()">
              </i>
              <i *ngIf="displayResetQualitiesIcon()"
                class="icofont icofont-ui-reply reply" 
                [placement]="'right'"
                [ngbTooltip]="'revenir aux valeurs d\'origines'"
                (click)="resetAllQualitiesValue()">
              </i>
            </div>

          </div>
          <!-- {{qualityFmNgModel | json}} -->

          <div class="row form-group">
            <label class="col-form-label col-lg-4 inline-label">Support :</label>
            <input 
              [(ngModel)]="newObject.NomSupport"
              type="text" 
              class="form-control col-lg-4 inline-input"
              id="support" 
              name="support"
              autocomplete="off">
              <div class="icons col-lg-2" *ngIf="selectionType === 'multi'">
                <i *ngIf="newObject.NomSupport !== ''"
                  class="icofont icofont-close-line-circled delete"
                  [placement]="'right'" 
                  [ngbTooltip]="resetTooltipMessage"
                  (click)="newObject.NomSupport = ''">
                </i>
                <!-- <i *ngIf="newObject.NomSupport !== valueNotToChangeLibelle"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="newObject.NomSupport = valueNotToChangeLibelle">
                </i> -->
                <i *ngIf="(newObject.NomSupport !== valueNotToChangeLibelle) && !checkIsOriginalProperty('NomSupport', newObject.NomSupport)"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="newObject.NomSupport = valueNotToChangeLibelle">
                </i>
                <i *ngIf="(newObject.NomSupport !== valueNotToChangeLibelle) 
                  && (checkIsOriginalProperty('NomSupport', newObject.NomSupport)
                  && newObject.NomSupport !== equalObject.NomSupport[0])" 
                  class="icofont icofont-ui-reply reply" 
                  [placement]="'right'"
                  [ngbTooltip]="replyTooltipMessage" 
                  (click)="checkIsOriginalProperty('NomSupport', newObject.NomSupport) ? 
                  newObject.NomSupport = equalObject.NomSupport[0] : 
                  newObject.NomSupport = valueNotToChangeLibelle">
                </i>
              </div>
          </div>
          <!-- <p *ngIf="myFicheAchatGlobal.chaines">Chaînes concernées :
            <span *ngFor="let item of myFicheAchatGlobal.chaines; let x = index">
              {{x === 0 ? item : ', '+item}}
            </span>
          </p> -->
          <p *ngIf="selectionType === 'one' || (selectionType === 'multi' && !multiFichesAchat)">Chaînes concernées :
            <span *ngIf="ficheAchatReady && ficheAchat.hasOwnProperty('lib_chaines') && ficheAchat.lib_chaines !== null && ficheAchat.lib_chaines !== []">
              <span *ngFor="let item of ficheAchat.lib_chaines; let x = index">
                {{x === 0 ? item : ', ' + item}}
              </span>
            </span>
            <span *ngIf="ficheAchatReady && (!ficheAchat.hasOwnProperty('lib_chaines') || ficheAchat.lib_chaines === null || ficheAchat.lib_chaines === [])">
              / 
            </span>
          </p>
          <p *ngIf="selectionType === 'multi' && multiFichesAchat && ficheAchatReady && ficheAchatMulti.lib_chaines && ficheAchatMulti.lib_chaines !== null && ficheAchatMulti.lib_chaines !== []">Chaînes concernées :
            <span *ngFor="let item of ficheAchatMulti.lib_chaines; let x = index">
              {{x === 0 ? item : ', ' + item}}
            </span>
          </p>
        </div>


        <!-- <div class="sections ori" *ngIf="selectionType === 'multi'">
          <i class="icofont icofont-space-shuttle section-icon"></i>
          <div class="row form-group">
            <label class="col-form-label col-lg-3">Retour Ori : </label>
            <select name="ori" class="form-control col-lg-6" [(ngModel)]="newObject.RetourOri" (click)="clickRetourOriOptions()">
              <option [ngValue]="newObject.RetourOri" *ngIf="initValueRetourOri">
                <span *ngIf="newObject.RetourOri !== valueNotToChangeLibelle">
                  {{retourOri[newObject.RetourOri-1].IdLibRetourOri}} - {{retourOri[newObject.RetourOri-1].Libelle}}
                </span>
                <span *ngIf="newObject.RetourOri === valueNotToChangeLibelle">
                  {{newObject.RetourOri}}
                </span>
              </option>
              <option *ngFor="let ori of retourOri" [ngValue]="ori.IdLibRetourOri">
                <span *ngIf="ori.IdLibRetourOri !== valueNotToChangeLibelle">{{ori.IdLibRetourOri}} - </span>
                {{ori.Libelle}}
              </option>
            </select>
          </div>
          <p *ngIf="selectionType === 'one' && ficheAchatDetailReady">Durée du prêt :
            <span>{{ficheAchatDetail.duree_du_pret}}</span>
          </p>
        
          <p *ngIf="selectionType === 'one' && ficheAchatDetailReady">Retour Ori dernier délai :
            <span *ngIf="lendingDurationDate ==! undefined">
              {{lendingDurationDate}}
            </span>
            <span *ngIf="lendingDurationDate === undefined">
              /
            </span>
          </p>
          <div class="form-group row livraison-datepicker" *ngIf="newObject.RetourOri === 3">
            <label class="col-lg-4 col-form-label">
              Date de retour :
            </label>
            <div class="input-group col-lg-6">
              <input class="form-control" 
                placeholder="{{displayPlaceholderDatepicker(newObject.DateRetourOri)}}" 
                name="retourDate"
                [(ngModel)]="newObject.DateRetourOri"
                ngbDatepicker 
                #retourDate="ngbDatepicker">
              <div class="input-group-append">
                <button class="btn btn-outline-secondary" (click)="retourDate.toggle()" type="button">
                  <i class="icofont icofont-calendar"></i>
                </button>
              </div>
            </div>
          </div>
        </div> -->



      </div>
      <div class="col-lg-4 fm-content">
        <!-- <div 
          class="sections droits" 
          *ngIf="(selectionType === 'one' || (selectionType === 'multi' && !multiOeuvre)) && ficheAchatDetailReady" 
          [ngStyle]="{'min-height': '170px'}"> -->
        <div 
          class="sections droits" 
          *ngIf="(selectionType === 'one' || (selectionType === 'multi' && !multiOeuvre)) && ficheAchatDetailReady" 
          [ngStyle]="{'min-height': '25%'}">
          <i class="icofont icofont-law section-icon"></i>
          <p class="deb-droits" *ngIf="ficheAchatDetailsExist">Date déb droits :
            <!-- <span>{{newObject.DateDebutDroit | date}}</span> -->
            <span *ngIf="ficheAchatDetail.debut_des_droits">{{ficheAchatDetail.debut_des_droits | date}}</span>
            <span *ngIf="!ficheAchatDetail.debut_des_droits">/</span>
          </p>
          <p class="deb-droits" *ngIf="!ficheAchatDetailsExist">Date déb droits :
            <i class="icofont icofont-minus-circle warning"></i>
            <span>{{messageNoFicheAchatDetail}}</span>
          </p>
          <!-- <p class="fin-droits">Fin des droits :
            <span *ngIf="ficheAchatDetail.expiration_droits">{{ficheAchatDetail.expiration_droits | date}}</span>
            <span *ngIf="!ficheAchatDetail.expiration_droits">/</span>
          </p> -->
          <p *ngIf="ficheAchatDetailsExist && ficheAchatDetail.duree_droits_annee">Fin des droits : {{ficheAchatDetail.duree_droits_annee}} an(s)</p>
          <p *ngIf="ficheAchatDetailsExist && !ficheAchatDetail.duree_droits_annee && ficheAchatDetail.duree_droits_mois && ficheAchatDetailsExist">Fin des droits : {{ficheAchatDetail.duree_droits_mois}} mois</p>
          <p *ngIf="ficheAchatDetailsExist && !ficheAchatDetail.duree_droits_annee && !ficheAchatDetail.duree_droits_mois && ficheAchatDetail.expiration_droits">Expiration droits : {{ficheAchatDetail.expiration_droits | json}}</p>
          <p *ngIf="ficheAchatDetailsExist && !ficheAchatDetail.duree_droits_annee && !ficheAchatDetail.duree_droits_mois && !ficheAchatDetail.expiration_droits">Fin des droits :
            <span class="empty-field">/</span>
          </p>
          <p *ngIf="!ficheAchatDetailsExist">Fin des droits :
            <i class="icofont icofont-minus-circle warning"></i>
            <span>{{messageNoFicheAchatDetail}}</span>
          </p>
        </div>

        <!-- <div 
          class="sections droits" 
          *ngIf="selectionType === 'multi' && multiOeuvre && ficheAchatDetailReady && ficheAchatDetailMulti" 
          [ngStyle]="{'min-height': '170px'}"> -->
        <div 
          class="sections droits" 
          *ngIf="selectionType === 'multi' && multiOeuvre && ficheAchatDetailReady && ficheAchatDetailMulti" 
          [ngStyle]="{'min-height': '25%'}">
          <i class="icofont icofont-law section-icon"></i>

          <p *ngIf="ficheAchatDetailMulti.debut_des_droits" class="deb-droits">Date déb droits :
            <!-- <span>{{newObject.DateDebutDroit | date}}</span> -->
            <span>{{ficheAchatDetailMulti.debut_des_droits | date}}</span>
          </p>
          <p *ngIf="!ficheAchatDetailMulti.debut_des_droits" class="deb-droits">Date déb droits :
            <!-- <span>{{newObject.DateDebutDroit | date}}</span> -->
            <span>/</span>
          </p>
          <!-- <p class="fin-droits">Fin des droits :
            <span *ngIf="ficheAchatDetail.expiration_droits">{{ficheAchatDetail.expiration_droits | date}}</span>
            <span *ngIf="!ficheAchatDetail.expiration_droits">/</span>
          </p> -->
          <p *ngIf="ficheAchatDetailMulti.hasOwnProperty('duree_droits_annee') && ficheAchatDetailMulti.duree_droits_annee !== null">Fin des droits : {{ficheAchatDetailMulti.duree_droits_annee}} an(s)</p>
          <p *ngIf="ficheAchatDetailMulti.hasOwnProperty('duree_droits_mois') && ficheAchatDetailMulti.duree_droits_mois !== null">Fin des droits : {{ficheAchatDetailMulti.duree_droits_mois}} mois</p>
          <p *ngIf="!ficheAchatDetailMulti.duree_droits_annee && !ficheAchatDetailMulti.duree_droits_mois && ficheAchatDetailMulti.expiration_droits">Expiration droits : {{ficheAchatDetailMulti.expiration_droits | json}}</p>
          <p *ngIf="!ficheAchatDetailMulti.duree_droits_annee && !ficheAchatDetailMulti.duree_droits_mois && !ficheAchatDetailMulti.expiration_droits">Fin des droits :
            <span class="empty-field">/</span>
          </p>
        </div>


        <!-- <div class="sections livraison" [ngStyle]="selectionType === 'multi' ? {'min-height': '455px'} : {'min-height': '480px', 'max-height': '480px'}"> -->
        <div class="sections livraison" [ngStyle]="{'min-height': 'calc(50% - 10px)'}">
          <i class="icofont icofont-clock-time section-icon"></i>
          <div *ngIf="!fmInRecording" class="form-group row livraison-datepicker livraison-date">
            <label class="col-lg-3 col-form-label label-livraison inline-label">
              Livraison :
            </label>
            <div *ngIf="!fmInRecording" class="input-group col-lg-6 inline-datepicker" (click)="displayOriLastDeadline(newObject.DateLivraison, newObject.duree_du_pret)">
              <input class="form-control" 
                [ngClass]="!checkValidDate(newObject.DateLivraison) && !fmInRecording ? 'form-control-danger' : ''"
                placeholder="{{newObject.DateLivraison}}" 
                name="livDate" 
                [(ngModel)]="newObject.DateLivraison" 
                ngbDatepicker
                (dateSelect)="displayValidDate(newObject.DateLivraison, 'livraison'); displayOriLastDeadline(newObject.DateLivraison, newObject.duree_du_pret)" 
                (keyup)="displayValidDate(newObject.DateLivraison, 'livraison'); displayOriLastDeadline(newObject.DateLivraison, newObject.duree_du_pret)"
                #livraison="ngModel"
                #livDate="ngbDatepicker">
              <div class="input-group-append">
                <button class="btn btn-outline-secondary" (click)="livDate.toggle()" type="button">
                  <i class="icofont icofont-calendar"></i>
                </button>
              </div>
            </div>
            <div class="col-lg-3 history-delivery-date">
              <delivery-date-comment-modal 
                [deliveryDate]="newObject.DateLivraison"
                [selectionType]="selectionType"
                [valueNotToChangeLibelle]="valueNotToChangeLibelle"
                [livraisonIsValid]= "livraisonIsValid"
                (newComment)="displayDeliveryDateModelComment($event)"
              ></delivery-date-comment-modal>
              <div class="history">
                <history-delivery-date-modal 
                  *ngIf="selectionType === 'one'"
                  [myFicheMateriel]="newObject"
                  [reload]="reload">
                </history-delivery-date-modal>
              </div>
              <!-- <div class="history" *ngIf="selectionType === 'multi'">
                <i class="icofont icofont-history"></i>
              </div> -->
            </div>
          </div>
          <div *ngIf="!checkValidDate(newObject.DateLivraison) && !fmInRecording" class="col-form-label invalid-form">La date de livraison n'est pas valide</div>
          <p *ngIf="(selectionType === 'one' || (selectionType === 'multi' && !multiOeuvre)) && ficheAchatDetailReady">
            <span *ngIf="ficheAchatDetailsExist">délai de vérif : {{ficheAchatDetail.delai_verification}} jours</span> 
            <span *ngIf="ficheAchatDetailsExist && propertyExist(ficheAchatDetail.delai_verification, ficheAchatDetail)">
              {{ficheAchatDetail.delai_verification}} jours
            </span>
            <span *ngIf="ficheAchatDetailsExist &&!ficheAchatDetail.delai_verification">/</span>
            <span *ngIf="!ficheAchatDetailsExist">délai de vérif :
              <i class="icofont icofont-minus-circle warning"></i>
              {{messageNoFicheAchatDetail}}
            </span>
          </p>
          <p *ngIf="selectionType === 'multi' && multiOeuvre && ficheAchatDetailReady && ficheAchatDetailMulti">Délai de vérif :
             {{ficheAchatDetailMulti.delai_verification}}
            <span *ngIf="propertyExist(ficheAchatDetailMulti.delai_verification, ficheAchatDetailMulti)">
              {{ficheAchatDetailMulti.delai_verification}} jours
            </span>
            <span *ngIf="!ficheAchatDetailMulti.delai_verification">/</span>
          </p>
          <div *ngIf="!fmInRecording" class="form-group row livraison-datepicker acceptation">
            <div class="form-check col-lg-5 inline-group">
              <label class=" radio">
                <input type="radio" 
                  name="radio" 
                  checked="{{checkAcceptationSelectionRadio() ? 'checked' : ''}}" 
                  [attr.disabled] = "newObject.IdLibstatut === 3 ? 'disabled' : null"
                  (click)="displayAcceptaionSelectionRadio()" > 
                <i class="helper"></i>Date d'acceptation :
              </label>
            </div>
            <div class="input-group col-lg-6 inline-datepicker">
              <input class="form-control"
                [ngClass]="!checkValidDate(newObject.DateAcceptation) && !fmInRecording ? 'form-control-danger' : ''"
                placeholder="{{newObject.DateAcceptation}}" 
                name="acceptDate"
                [(ngModel)]="newObject.DateAcceptation" 
                ngbDatepicker 
                (dateSelect)="displayValidDate(newObject.DateAcceptation, 'acceptation')"
                (keyup)="displayValidDate(newObject.DateAcceptation, 'acceptation')"
                #acceptation="ngModel"
                #acceptDate="ngbDatepicker" 
                disabled="{{!checkAcceptationSelectionRadio()}}">
              <div class="input-group-append">
                <button class="btn btn-outline-secondary" (click)="acceptDate.toggle()" type="button">
                  <i class="icofont icofont-calendar"></i>
                </button>
              </div>
            </div>
          </div>
          <div *ngIf="!checkValidDate(newObject.DateAcceptation) && !fmInRecording" class="col-form-label invalid-form">La date d'acceptation n'est pas valide</div>
          <div class="form-group row renouvellement">
            <div class="form-check col-lg-12">
              <label class=" radio">
                <input 
                  type="radio" 
                  name="radio" 
                  [attr.disabled] = "newObject.IdLibstatut === 3 ? 'disabled' : null"
                  (click)="displayRenouvellementSelectionRadio()" 
                  checked="{{checkRenouvellementSelectionRadio()}}">
                <i class="helper"></i>Renouvellement
              </label>
            </div>
          </div>

          <div *ngIf="!fmInRecording" class="form-group row livraison-datepicker diff">
            <label class="col-lg-5 col-form-label inline-label">
              Date de première diff :
            </label>
            <div class="input-group col-lg-6 inline-datepicker">
              <input 
                [ngClass]="!checkValidDate(newObject.DatePremiereDiff) && !fmInRecording ? 'form-control-danger' : ''"
                class="form-control" 
                placeholder="{{newObject.DatePremiereDiff}}" 
                name="diffDate"
                [(ngModel)]="newObject.DatePremiereDiff"
                (dateSelect)="displayValidDate(newObject.DatePremiereDiff, 'diff')"
                ngbDatepicker 
                (keyup)="displayValidDate(newObject.DatePremiereDiff, 'diff')"
                #diff="ngModel"
                #diffDate="ngbDatepicker">
              <div class="input-group-append">
                <button class="btn btn-outline-secondary" (click)="diffDate.toggle()" type="button" [ngClass]="warningDateDiffExist ? 'warning-btn' : ''">
                  <i class="icofont icofont-calendar"></i>
                </button>
              </div>
            </div>
          </div>
          <div *ngIf="!checkValidDate(newObject.DatePremiereDiff) && !fmInRecording" class="col-form-label invalid-form">La date de première diff n'est pas valide</div>
          <div *ngIf="warningDateDiffExist && !fmInRecording && dateDiffDaysDiff > 0 && dateDiffDaysDiff <= 30" class="diff-message">La date de première diff est dans   
            <span class="day-diff">{{dateDiffDaysDiff}}</span>
            <span *ngIf="dateDiffDaysDiff > 1">jours</span>
            <span *ngIf="dateDiffDaysDiff === 1">jour</span>
          </div>
          <div *ngIf="warningDateDiffExist && !fmInRecording && dateDiffDaysDiff < 0" class="diff-message">La date de première diff est dépassée</div>
        </div>
        <!-- <div class="sections acces-vf" [ngStyle]="selectionType === 'multi' ? {'min-height': '195px'} : {'min-height': '290px', 'max-height': '290px'}"> -->
        <div class="sections acces-vf" [ngStyle]="{'min-height': 'calc(25% - 10px)'}">
          <i class="icofont icofont-unlock section-icon"></i>
          <label class="col-form-label col-lg-4 inline-label">Accès VF :</label>
          <div class="row form-group textarea-inline">
            <textarea 
              [(ngModel)]="newObject.AccesVF"
              type="text" 
              class="form-control md-textarea col-lg-8" 
              id="accesVf" 
              name="accesVf"
              autocomplete="off">
            </textarea>
            <div class="icons col-lg-3 textarea-icons" *ngIf="selectionType === 'multi'">
              <i *ngIf="newObject.AccesVF !== ''"
                class="icofont icofont-close-line-circled delete"
                [placement]="'right'" 
                [ngbTooltip]="resetTooltipMessage"
                (click)="newObject.AccesVF = ''">
              </i>
              <!-- <i *ngIf="newObject.AccesVF !== valueNotToChangeLibelle"
                class="icofont icofont-ui-reply reply"
                [placement]="'right'" 
                [ngbTooltip]="replyTooltipMessage"
                (click)="newObject.AccesVF = valueNotToChangeLibelle">
              </i> -->
              <i *ngIf="(newObject.AccesVF !== valueNotToChangeLibelle) && !checkIsOriginalProperty('AccesVF', newObject.AccesVF)"
                class="icofont icofont-ui-reply reply"
                [placement]="'right'" 
                [ngbTooltip]="replyTooltipMessage"
                (click)="newObject.AccesVF = valueNotToChangeLibelle">
              </i>
              <i *ngIf="(newObject.AccesVF !== valueNotToChangeLibelle) 
                && (checkIsOriginalProperty('AccesVF', newObject.AccesVF)
                && newObject.AccesVF !== equalObject.AccesVF[0])" 
                class="icofont icofont-ui-reply reply" 
                [placement]="'right'"
                [ngbTooltip]="replyTooltipMessage" 
                (click)="checkIsOriginalProperty('AccesVF', newObject.AccesVF) ? 
                newObject.AccesVF = equalObject.AccesVF[0] : 
                newObject.AccesVF = valueNotToChangeLibelle">
              </i>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-4 fm-content">
        <!-- <div class="sections press" [ngStyle]="selectionType === 'multi' ? {'min-height': '215px'} : {'min-height': '285px'}"> -->
        <div class="sections press" [ngStyle]="{'min-height': 'calc(30% - 10px)'}">
          <i class="icofont icofont-newspaper section-icon"></i>
          <div class="row form-group" [ngStyle]="selectionType === 'multi' ? {} : {'margin-top': '60px'}">
            <label class="col-form-label col-lg-5 inline-label">Elements annexes :</label>
            <select name="step" class="form-control col-lg-6 inline-input" 
                    [disabled]="newObject.IdLibstatut === 3 ? true : false"
                    [(ngModel)]="newObject.IdStatutElementsAnnexes" 
                    (click)="clickAnnexElementOptions()">
              <option [ngValue]="newObject.IdStatutElementsAnnexes" *ngIf="initAnnexElements">
                <span *ngIf="newObject.IdStatutElementsAnnexes !== valueNotToChangeLibelle">
                  {{newObject.IdStatutElementsAnnexes}} - {{annexElementsStatus[newObject.IdStatutElementsAnnexes-1].Libelle}}
                </span>
                <span *ngIf="newObject.IdStatutElementsAnnexes === valueNotToChangeLibelle">{{newObject.IdStatutElementsAnnexes}}</span>
              </option>
              <option *ngFor="let element of annexElementsStatus" [ngValue]="element.IdStatutElementsAnnexes"><span *ngIf="element.Libelle !== valueNotToChangeLibelle">{{element.IdStatutElementsAnnexes}} - </span>{{element.Libelle}}</option>
            </select>
          </div>
          <div class="row form-group annexes-elements">
            <annexes-elements-modification-modal 
              *ngIf="categoriesReady"
              [allIdSelectedFichesMateriel]="allIdSelectedFichesMateriel"
              (newStateElementsAnnexNgModel)="displayStateElementsAnnexNgModel($event)"
              (newComments)="displaynewEAComments($event)"
              [selectionType]="selectionType"
              [annexElementsNgModel]="annexElementsNgModel"
              [originalsValuesElementsAnnexes]="originalsValuesElementsAnnexes"
              [comments]="comments"
              [reload]="reload"
              [refreshEACommentModel]="refreshEACommentModel"
              [sameEAComments]="sameEAComments"
              [resetTooltipMessage]= "resetTooltipMessage"
              [replyTooltipMessage]= "replyTooltipMessage"
              [valueNotToChangeLibelle]="valueNotToChangeLibelle"
              [annexElementsFicheMateriel]="annexElementsFicheMateriel">
            </annexes-elements-modification-modal>
            <!-- {{comments |json}} -->
          </div>
          <!-- <div class="details row form-group" *ngIf="selectionType === 'multi'">
            <div class="left-details col-lg-6">
              <div *ngFor="let item of newObject.Fiche_Mat_ElementsAnnexes; let i = index" class="checkbox-color checkbox-info">
                <input *ngIf="i<6" id="{{i}}" 
                  name="{{i}}" 
                  type="checkbox" 
                  [(ngModel)]="newObject.Fiche_Mat_ElementsAnnexes[i].IsValid">
                <label *ngIf="i<6" for="{{i}}">
                  {{item.libelle}}
                </label>
              </div>
            </div>
            <div class="right-details col-lg-6">
              <div *ngFor="let item of newObject.Fiche_Mat_ElementsAnnexes; let i = index" class="checkbox-color checkbox-info">
                <input *ngIf="i>5" id="{{i}}" 
                type="checkbox" 
                name="{{i}}"
                [(ngModel)]="newObject.Fiche_Mat_ElementsAnnexes[i].IsValid">
                <label *ngIf="i>5" for="{{i}}">
                  {{item.libelle}}
                </label>
              </div>
            </div>
          </div> -->

          <!-- <div class="row buttons" *ngIf="selectionType === 'multi'" [ngClass]="selectionType === 'multi' ? 'multi' : ''">
            <button class="btn btn-danger btn-outline-danger"
              *ngIf="checkModifiedElementAnnex(newObject.Fiche_Mat_ElementsAnnexes, null, 'same')"
              [placement]="'right'" 
              [ngbTooltip]="resetTooltipMessage"
              (click)="resetElementAnnex(newObject.Fiche_Mat_ElementsAnnexes, false)">
              <i class="icofont icofont-close-line-circled delete"></i>
              Aucun element sélectionné
            </button>
            <button class="btn btn-danger btn-outline-danger" 
              *ngIf="checkModifiedElementAnnex(newObject.Fiche_Mat_ElementsAnnexes, null, 'different')"
              [placement]="'right'" 
              [ngbTooltip]="replyTooltipMessage"
              (click)="resetElementAnnex(newObject.Fiche_Mat_ElementsAnnexes, null)">
              <i class="icofont icofont-ui-reply reply"></i>
              Rétablir valeurs d'origines
            </button>
          </div> -->


          <!-- voir quel attribut correspond à ce commentaire -->
        </div>
        <!-- <div class="sections ori" [ngStyle]="selectionType === 'multi' ? {'min-height': '140px'} : {'min-height': '270px'}"> -->
        <div class="sections ori" [ngStyle]="{'min-height': '30%'}">
          <i class="icofont icofont-space-shuttle section-icon"></i>
          <div class="row form-group retour-ori" [ngStyle]="selectionType === 'multi' ? {'margin-top': '0'} : {'margin-top': '30px'}">
            <label class="col-form-label col-lg-3 inline-label">Retour Ori : </label>
            <select name="ori" class="form-control col-lg-6 inline-input" [(ngModel)]="newObject.RetourOri" (click)="clickRetourOriOptions()">
              <option [ngValue]="newObject.RetourOri" *ngIf="initValueRetourOri">
                <span *ngIf="newObject.RetourOri !== valueNotToChangeLibelle">
                  {{retourOri[newObject.RetourOri-1].IdLibRetourOri}} - {{retourOri[newObject.RetourOri-1].Libelle}}
                </span>
                <span *ngIf="newObject.RetourOri === valueNotToChangeLibelle">
                   {{newObject.RetourOri}}
                </span>
              </option>
              <option *ngFor="let ori of retourOri" [ngValue]="ori.IdLibRetourOri">
                <span *ngIf="ori.IdLibRetourOri !== valueNotToChangeLibelle">{{ori.IdLibRetourOri}} - </span>
                {{ori.Libelle}}
              </option>
            </select>
          </div>
          <div class="row form-group">
            <label class="col-lg-5 col-form-label inline-label">Durée du prêt (en jours) :</label>
            <input [(ngModel)]="newObject.duree_du_pret" 
              type="text" 
              class="form-control input-group col-lg-4 inline-input" 
              id="dureePret" 
              name="dureePret"
              (keyup)="displayOriLastDeadline(newObject.DateLivraison, newObject.duree_du_pret)"
              (keypress)="checkInputNumberOnly($event)"
              autocomplete="off">
          </div>
          <!-- <p *ngIf="(selectionType === 'one' || (selectionType === 'multi' && !multiOeuvre)) && ficheAchatDetailsExist && ficheAchatDetailReady && newObject.RetourOri === 1">Durée du prêt :
            
            <span>{{ficheAchatDetail.duree_du_pret}} jour(s)</span>
          </p>
          <p *ngIf="selectionType === 'multi' && multiOeuvre && ficheAchatDetailReady && newObject.RetourOri === 1 && ficheAchatDetailMulti.duree_du_pret">Durée du prêt :
            <span>{{ficheAchatDetailMulti.duree_du_pret}} jour(s)</span>
          </p>
          <p *ngIf="(selectionType === 'one' || (selectionType === 'multi' && !multiOeuvre)) && ficheAchatDetailReady && newObject.RetourOri === 1">Retour Ori dernier délai :
            <span *ngIf="lendingDurationDate !== undefined ">
              {{lendingDurationDate | date}}
            </span>
            <span *ngIf="lendingDurationDate === undefined">
              /
            </span>
          </p> -->
          <p *ngIf="newObject.RetourOri === 1 && displayRetourOriDernierDelai">Retour Ori dernier délai :
            <span *ngIf="newObject.RetourOriDernierDelai !== valueNotToChangeLibelle">{{newObject.RetourOriDernierDelai | date}}</span>
            <span *ngIf="newObject.RetourOriDernierDelai === valueNotToChangeLibelle">{{newObject.RetourOriDernierDelai}}</span>
          </p>
           
          <div class="form-group row livraison-datepicker" *ngIf="newObject.RetourOri === 3">
            <label class="col-lg-4 col-form-label">
              Date de retour :
            </label>
            <div class="input-group col-lg-6">
              <input 
                class="form-control"
                [ngClass]="!checkValidDate(newObject.DateRetourOri) && !fmInRecording ? 'form-control-danger' : ''"
                placeholder="{{newObject.DateRetourOri}}" 
                name="rDate"
                [(ngModel)]="newObject.DateRetourOri" 
                ngbDatepicker
                (dateSelect)="displayValidDate(newObject.DateRetourOri, 'ori')"
                (keyup)="displayValidDate(newObject.DateRetourOri, 'ori')"
                #ori="ngModel"
                #retourDate="ngbDatepicker">
              <div class="input-group-append">
                <button class="btn btn-outline-secondary" (click)="retourDate.toggle()" type="button">
                  <i class="icofont icofont-calendar"></i>
                </button>
              </div>
            </div>
          </div>
          <div *ngIf="!checkValidDate(newObject.DateRetourOri) && !fmInRecording && newObject.RetourOri === 3" class="col-form-label invalid-form">La date de retour n'est pas valide</div>
        </div>

<!--- ***************  SECTION RECEPTION LABO ***************** -->
        <!-- <div class="sections labo" [ngStyle]="selectionType === 'multi' ? {'min-height': '285px'} : {'min-height': '385px'}"> -->
        <div class="sections labo" [ngStyle]="{'min-height': 'calc(40% - 10px)'}">
          <i class="icofont icofont-beaker section-icon"></i>
          <div *ngIf="!fmInRecording" class="form-group row livraison-datepicker section-labo" [ngStyle]="selectionType === 'multi' ? {'margin-top': '10px'} : {'margin-top': '35px'}">
            <label class="col-lg-5 col-form-label inline-label">
              Réception accès labo :
            </label>
            <div class="input-group col-lg-6 inline-datepicker">
              <input 
                [ngClass]="!checkValidDate(newObject.ReceptionAccesLabo) && !fmInRecording ? 'form-control-danger' : ''"
                class="form-control" 
                placeholder="{{newObject.ReceptionAccesLabo}}" 
                name="accLaboDate"
                [(ngModel)]="newObject.ReceptionAccesLabo" 
                ngbDatepicker 
                (dateSelect)="displayValidDate(newObject.ReceptionAccesLabo, 'labo')"
                (keyup)="displayValidDate(newObject.ReceptionAccesLabo, 'labo')"
                #accesLabo="ngModel"
                #accLaboDate="ngbDatepicker">
              <div class="input-group-append">
                <button class="btn btn-outline-secondary" (click)="accLaboDate.toggle()" type="button">
                  <i class="icofont icofont-calendar"></i>
                </button>
              </div>
            </div>
          </div>
          <div *ngIf="!checkValidDate(newObject.ReceptionAccesLabo) && !fmInRecording" class="col-form-label invalid-form">La date d'accès Labo n'est pas valide</div>
          <div class="row form-group form-labo">
            <label class="col-form-label col-lg-4 inline-label">Nom du labo :</label>
            <input 
              [(ngModel)]="newObject.NomLabo"
              type="text" 
              class="form-control col-lg-4 inline-input" 
              id="laboName" 
              name="laboName"
              autocomplete="off">
              <div class="icons col-lg-2" *ngIf="selectionType === 'multi'">
                <i *ngIf="newObject.NomLabo !== ''"
                  class="icofont icofont-close-line-circled delete"
                  [placement]="'right'" 
                  [ngbTooltip]="resetTooltipMessage"
                  (click)="newObject.NomLabo = ''">
                </i>
                <!-- <i *ngIf="newObject.NomLabo !== valueNotToChangeLibelle"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="newObject.NomLabo = valueNotToChangeLibelle">
                </i> -->
                <i *ngIf="(newObject.NomLabo !== valueNotToChangeLibelle) && !checkIsOriginalProperty('NomLabo', newObject.NomLabo)"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="newObject.NomLabo = valueNotToChangeLibelle">
                </i>
                <i *ngIf="(newObject.NomLabo !== valueNotToChangeLibelle) 
                  && (checkIsOriginalProperty('NomLabo', newObject.NomLabo)
                  && newObject.NomLabo !== equalObject.NomLabo[0])" 
                  class="icofont icofont-ui-reply reply" 
                  [placement]="'right'"
                  [ngbTooltip]="replyTooltipMessage" 
                  (click)="checkIsOriginalProperty('NomLabo', newObject.NomLabo) ? 
                  newObject.NomLabo = equalObject.NomLabo[0] : 
                  newObject.NomLabo = valueNotToChangeLibelle">
                </i>
              </div>
          </div>
          <div class="row form-group form-labo">
            <label class="col-form-label col-lg-4 inline-label">Coût labo :</label>
            <input 
              [(ngModel)]="newObject.CoutLabo"
              type="text" 
              class="form-control col-lg-4 inline-input" 
              id="laboCost" 
              name="laboCost"
              autocomplete="off">
              <div class="icons col-lg-2" *ngIf="selectionType === 'multi'">
                <i *ngIf="newObject.CoutLabo !== ''"
                  class="icofont icofont-close-line-circled delete"
                  [placement]="'right'" 
                  [ngbTooltip]="resetTooltipMessage"
                  (click)="newObject.CoutLabo = ''">
                </i>
                <!-- <i *ngIf="newObject.CoutLabo !== valueNotToChangeLibelle"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="newObject.CoutLabo = valueNotToChangeLibelle">
                </i> -->
                <i *ngIf="(newObject.CoutLabo !== valueNotToChangeLibelle) && !checkIsOriginalProperty('CoutLabo', newObject.CoutLabo)"
                  class="icofont icofont-ui-reply reply"
                  [placement]="'right'" 
                  [ngbTooltip]="replyTooltipMessage"
                  (click)="newObject.CoutLabo = valueNotToChangeLibelle">
                </i>
                <i *ngIf="(newObject.CoutLabo !== valueNotToChangeLibelle) 
                  && (checkIsOriginalProperty('CoutLabo', newObject.CoutLabo)
                  && newObject.CoutLabo !== equalObject.CoutLabo[0])" 
                  class="icofont icofont-ui-reply reply" 
                  [placement]="'right'"
                  [ngbTooltip]="replyTooltipMessage" 
                  (click)="checkIsOriginalProperty('CoutLabo', newObject.CoutLabo) ? 
                  newObject.CoutLabo = equalObject.CoutLabo[0] : 
                  newObject.CoutLabo = valueNotToChangeLibelle">
                </i>
              </div>
          </div>
        </div>
<!--- ******************************************************** -->


      </div>
    </div>
    <div class="row fm-detail-comment">
      <div class="col-lg-12 comment">
        <p>Commentaire :</p>
        <div class="comment-content row">
          <textarea 
            [(ngModel)]="newObject.Commentaires"
            type="text" 
            class="form-control md-textarea col-lg-10" 
            id="commentaires" 
            name="commentaires"
            autocomplete="off">
          </textarea>
          <div class="icons col-lg-2 textarea-icons" *ngIf="selectionType === 'multi'">
            <i *ngIf="newObject.Commentaires !== ''"
              class="icofont icofont-close-line-circled delete"
              [placement]="'right'" 
              [ngbTooltip]="resetTooltipMessage"
              (click)="newObject.Commentaires = ''">
            </i>
            <!-- <i *ngIf="newObject.Commentaires !== valueNotToChangeLibelle"
              class="icofont icofont-ui-reply reply"
              [placement]="'right'" 
              [ngbTooltip]="replyTooltipMessage"
              (click)="newObject.Commentaires = valueNotToChangeLibelle">
            </i> -->
            <i *ngIf="(newObject.Commentaires !== valueNotToChangeLibelle) && !checkIsOriginalProperty('Commentaires', newObject.Commentaires)"
              class="icofont icofont-ui-reply reply"
              [placement]="'right'" 
              [ngbTooltip]="replyTooltipMessage"
              (click)="newObject.Commentaires = valueNotToChangeLibelle">
            </i>
            <i *ngIf="(newObject.Commentaires !== valueNotToChangeLibelle) 
              && (checkIsOriginalProperty('Commentaires', newObject.Commentaires)
              && newObject.Commentaires !== equalObject.Commentaires[0])" 
              class="icofont icofont-ui-reply reply" 
              [placement]="'right'"
              [ngbTooltip]="replyTooltipMessage" 
              (click)="checkIsOriginalProperty('Commentaires', newObject.Commentaires) ? 
              newObject.Commentaires = equalObject.Commentaires[0] : 
              newObject.Commentaires = valueNotToChangeLibelle">
            </i>
          </div>
        </div>
      </div>
    </div>
  </div>
    <!-- <div class="row fm-detail-footer">
      <div class="col-lg-2 offset-lg-10 footer-links">
        <custom-icon-badge *ngFor="let icon of icons" [littleIcon]="icon.littleIcon" [bigIcon]="icon.bigIcon" [link]="icon.link"
          [action]="icon.action" [tooltip]="icon.tooltip" [tooltipMessage]="icon.tooltipMessage">
        </custom-icon-badge>
      </div>
    </div> -->
    <fiches-materiel-modification-action
      (modificationMessage)="displayModificationMessage($event)"
      (propertiesChanged)="resetPropertiesChanged($event)"
      (modifInProgressMessage)="displayModifInProgressMessage($event)"
      (fmInRecordingEvent)="checkCurrentRecord($event)"
      [fmInRecording]="fmInRecording"
      [showAffectedEps]="true"
      [annexElementsNgModel]="annexElementsNgModel"
      [allFichesMateriel]="allFichesMateriel"
      [selectionType]="selectionType"
      [multiOeuvre]="multiOeuvre"
      [multiFichesAchat]="multiFichesAchat"
      [initialFichesMateriel]="initialFichesMateriel"
      [valueNotToChangeLibelle]="valueNotToChangeLibelle"
      [allIdSelectedFichesMateriel]="allIdSelectedFichesMateriel"
      [allAnnexElementsFicheMateriel]="allAnnexElementsFicheMateriel"
      [qualiteFM]="qualiteFM"
      [versionFicheMateriel]="versionFicheMateriel"
      [annexElementsFicheMateriel]="annexElementsFicheMateriel"
      [user]="user"
      [deadlineIsValid]="deadlineIsValid"
      [livraisonIsValid]="livraisonIsValid"
      [acceptationIsValid]="acceptationIsValid"
      [oriIsValid]="oriIsValid"
      [premiereDiff]="premiereDiff"
      [accesLabo]="accesLabo"
      [comments]="comments"
      [allEACommentsMultiSelect]="allEACommentsMultiSelect"
      [allVersionFm]="allVersionFm"
      [versionFmNgModel]="versionFmNgModel"
      [allQualitiesFm]="allQualitiesFm"
      [qualityFmNgModel]="qualityFmNgModel"
      [newObject]="newObject">
    </fiches-materiel-modification-action>
  </form>
</div>
